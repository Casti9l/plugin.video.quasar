import xbmcgui
from dialog import *  # NOQA

class DialogSelect(xbmcgui.WindowXMLDialog):
    def __init__(self, *args, **kwargs):
        xbmcgui.WindowXML.__init__(self)
        self.items = kwargs['items']
        self.title = kwargs['title']
        self.count = 0
        self.retval = -1

    def onInit(self):
        self.getControl(32501).setLabel(self.title)
        for item in self.items:
            labels = item.split('\n')
            label1 = labels[0]
            try:
                label2 = labels[1]
            except:
                label2 = ''
            self.addItem(label1, label2)

    def onClick(self, controlId):
        if controlId == 32500:
            # Close Button
            self.close()
        elif controlId == 32503:
            # Panel
            listControl = self.getControl(32503)
            selected = listControl.getSelectedItem()
            self.retval = int(selected.getProperty('index'))
            self.close()

    def onAction(self, action):
        if action.getId() in [ACTION_PARENT_DIR, KEY_NAV_BACK, ACTION_PREVIOUS_MENU]:
            self.close()

    def addItem(self, label1, label2):
        listControl = self.getControl(32503)
        item = xbmcgui.ListItem("[B]%s[/B]" % label1, label2)
        item.setProperty('index', str(self.count))
        listControl.addItem(item)
        self.count += 1
